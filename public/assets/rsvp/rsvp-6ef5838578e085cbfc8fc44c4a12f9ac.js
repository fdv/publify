(function(){"use strict";function t(t){return"function"==typeof t||"object"==typeof t&&null!==t}function n(t){return"function"==typeof t}function r(t){return"object"==typeof t&&null!==t}function e(){}function o(t,n){for(var r=0,e=t.length;e>r;r++)if(t[r]===n)return r;return-1}function i(t){var n=t._promiseCallbacks;return n||(n=t._promiseCallbacks={}),n}function u(t,n){return"onerror"===t?void En.on("error",n):2!==arguments.length?En[t]:void(En[t]=n)}function s(){setTimeout(function(){for(var t,n=0;n<An.length;n++){t=An[n];var r=t.payload;r.guid=r.key+r.id,r.childGuid=r.key+r.childId,r.error&&(r.stack=r.error.stack),En.trigger(t.name,t.payload)}An.length=0},50)}function a(t,n,r){1===An.push({name:t,payload:{key:n._guidKey,id:n._id,eventName:t,detail:n._result,childId:r&&r._id,label:n._label,timeStamp:wn(),error:En["instrument-with-stack"]?new Error(n._label):null}})&&s()}function c(){return new TypeError("A promises callback cannot return that same promise.")}function f(){}function l(t){try{return t.then}catch(n){return Cn.error=n,Cn}}function h(t,n,r,e){try{t.call(n,r,e)}catch(o){return o}}function p(t,n,r){En.async(function(t){var e=!1,o=h(r,n,function(r){e||(e=!0,n!==r?v(t,r):m(t,r))},function(n){e||(e=!0,w(t,n))},"Settle: "+(t._label||" unknown promise"));!e&&o&&(e=!0,w(t,o))},t)}function _(t,n){n._state===Sn?m(t,n._result):n._state===kn?(n._onError=null,w(t,n._result)):g(n,void 0,function(r){n!==r?v(t,r):m(t,r)},function(n){w(t,n)})}function d(t,r){if(r.constructor===t.constructor)_(t,r);else{var e=l(r);e===Cn?w(t,Cn.error):void 0===e?m(t,r):n(e)?p(t,r,e):m(t,r)}}function v(n,r){n===r?m(n,r):t(r)?d(n,r):m(n,r)}function y(t){t._onError&&t._onError(t._result),b(t)}function m(t,n){t._state===Tn&&(t._result=n,t._state=Sn,0===t._subscribers.length?En.instrument&&jn("fulfilled",t):En.async(b,t))}function w(t,n){t._state===Tn&&(t._state=kn,t._result=n,En.async(y,t))}function g(t,n,r,e){var o=t._subscribers,i=o.length;t._onError=null,o[i]=n,o[i+Sn]=r,o[i+kn]=e,0===i&&t._state&&En.async(b,t)}function b(t){var n=t._subscribers,r=t._state;if(En.instrument&&jn(r===Sn?"fulfilled":"rejected",t),0!==n.length){for(var e,o,i=t._result,u=0;u<n.length;u+=3)e=n[u],o=n[u+r],e?j(r,e,o,i):o(i);t._subscribers.length=0}}function E(){this.error=null}function A(t,n){try{return t(n)}catch(r){return On.error=r,On}}function j(t,r,e,o){var i,u,s,a,f=n(e);if(f){if(i=A(e,o),i===On?(a=!0,u=i.error,i=null):s=!0,r===i)return void w(r,c())}else i=o,s=!0;r._state!==Tn||(f&&s?v(r,i):a?w(r,u):t===Sn?m(r,i):t===kn&&w(r,i))}function T(t,n){var r=!1;try{n(function(n){r||(r=!0,v(t,n))},function(n){r||(r=!0,w(t,n))})}catch(e){w(t,e)}}function S(t,n,r){return t===Sn?{state:"fulfilled",value:r}:{state:"rejected",reason:r}}function k(t,n,r,e){this._instanceConstructor=t,this.promise=new t(f,e),this._abortOnReject=r,this._validateInput(n)?(this._input=n,this.length=n.length,this._remaining=n.length,this._init(),0===this.length?m(this.promise,this._result):(this.length=this.length||0,this._enumerate(),0===this._remaining&&m(this.promise,this._result))):w(this.promise,this._validationError())}function C(t,n){return new In(this,t,!0,n).promise}function O(t,n){function r(t){v(i,t)}function e(t){w(i,t)}var o=this,i=new o(f,n);if(!mn(t))return w(i,new TypeError("You must pass an array to race.")),i;for(var u=t.length,s=0;i._state===Tn&&u>s;s++)g(o.resolve(t[s]),void 0,r,e);return i}function I(t,n){var r=this;if(t&&"object"==typeof t&&t.constructor===r)return t;var e=new r(f,n);return v(e,t),e}function R(t,n){var r=this,e=new r(f,n);return w(e,t),e}function M(){throw new TypeError("You must pass a resolver function as the first argument to the promise constructor")}function P(){throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.")}function x(t,r){this._id=Yn++,this._label=r,this._state=void 0,this._result=void 0,this._subscribers=[],En.instrument&&jn("created",this),f!==t&&(n(t)||M(),this instanceof x||P(),T(this,t))}function N(t,n,r){this._superConstructor(t,n,!1,r)}function Y(t,n){return new N(Dn,t,n).promise}function D(t,n){return Dn.all(t,n)}function K(t,n){Hn[Gn]=t,Hn[Gn+1]=n,Gn+=2,2===Gn&&Un()}function U(){var t=process.nextTick,n=process.versions.node.match(/^(?:(\d+)\.)?(?:(\d+)\.)?(\*|\d+)$/);return Array.isArray(n)&&"0"===n[1]&&"10"===n[2]&&(t=setImmediate),function(){t(V)}}function q(){return function(){Kn(V)}}function F(){var t=0,n=new $n(V),r=document.createTextNode("");return n.observe(r,{characterData:!0}),function(){r.data=t=++t%2}}function G(){var t=new MessageChannel;return t.port1.onmessage=V,function(){t.port2.postMessage(0)}}function L(){return function(){setTimeout(V,1)}}function V(){for(var t=0;Gn>t;t+=2){var n=Hn[t],r=Hn[t+1];n(r),Hn[t]=void 0,Hn[t+1]=void 0}Gn=0}function W(){try{var t=require,n=t("vertx");return Kn=n.runOnLoop||n.runOnContext,q()}catch(r){return L()}}function $(t){var n={};return n.promise=new Dn(function(t,r){n.resolve=t,n.reject=r},t),n}function z(t,r,e){return Dn.all(t,e).then(function(t){if(!n(r))throw new TypeError("You must pass a function as filter's second argument.");for(var o=t.length,i=new Array(o),u=0;o>u;u++)i[u]=r(t[u]);return Dn.all(i,e).then(function(n){for(var r=new Array(o),e=0,i=0;o>i;i++)n[i]&&(r[e]=t[i],e++);return r.length=e,r})})}function B(t,n,r){this._superConstructor(t,n,!0,r)}function H(t,n,r){this._superConstructor(t,n,!1,r)}function J(t,n){return new H(Dn,t,n).promise}function Q(t,n){return new Xn(Dn,t,n).promise}function X(t,r,e){return Dn.all(t,e).then(function(t){if(!n(r))throw new TypeError("You must pass a function as map's second argument.");for(var o=t.length,i=new Array(o),u=0;o>u;u++)i[u]=r(t[u]);return Dn.all(i,e)})}function Z(){this.value=void 0}function tn(t){try{return t.then}catch(n){return rr.value=n,rr}}function nn(t,n,r){try{t.apply(n,r)}catch(e){return rr.value=e,rr}}function rn(t,n){for(var r,e,o={},i=t.length,u=new Array(i),s=0;i>s;s++)u[s]=t[s];for(e=0;e<n.length;e++)r=n[e],o[r]=u[e+1];return o}function en(t){for(var n=t.length,r=new Array(n-1),e=1;n>e;e++)r[e-1]=t[e];return r}function on(t,n){return{then:function(r,e){return t.call(n,r,e)}}}function un(t,n){var r=function(){for(var r,e=this,o=arguments.length,i=new Array(o+1),u=!1,s=0;o>s;++s){if(r=arguments[s],!u){if(u=cn(r),u===er){var a=new Dn(f);return w(a,er.value),a}u&&u!==!0&&(r=on(u,r))}i[s]=r}var c=new Dn(f);return i[o]=function(t,r){t?w(c,t):void 0===n?v(c,r):n===!0?v(c,en(arguments)):mn(n)?v(c,rn(arguments,n)):v(c,r)},u?an(c,i,t,e):sn(c,i,t,e)};return r.__proto__=t,r}function sn(t,n,r,e){var o=nn(r,e,n);return o===rr&&w(t,o.value),t}function an(t,n,r,e){return Dn.all(n).then(function(n){var o=nn(r,e,n);return o===rr&&w(t,o.value),t})}function cn(t){return t&&"object"==typeof t?t.constructor===Dn?!0:tn(t):!1}function fn(t,n){return Dn.race(t,n)}function ln(t,n){return Dn.reject(t,n)}function hn(t,n){return Dn.resolve(t,n)}function pn(t){throw setTimeout(function(){throw t}),t}function _n(t,n){En.async(t,n)}function dn(){En.on.apply(En,arguments)}function vn(){En.off.apply(En,arguments)}var yn;yn=Array.isArray?Array.isArray:function(t){return"[object Array]"===Object.prototype.toString.call(t)};var mn=yn,wn=Date.now||function(){return(new Date).getTime()},gn=Object.create||function(t){if(arguments.length>1)throw new Error("Second argument not supported");if("object"!=typeof t)throw new TypeError("Argument must be an object");return e.prototype=t,new e},bn={mixin:function(t){return t.on=this.on,t.off=this.off,t.trigger=this.trigger,t._promiseCallbacks=void 0,t},on:function(t,n){var r,e=i(this);r=e[t],r||(r=e[t]=[]),-1===o(r,n)&&r.push(n)},off:function(t,n){var r,e,u=i(this);return n?(r=u[t],e=o(r,n),void(-1!==e&&r.splice(e,1))):void(u[t]=[])},trigger:function(t,n){var r,e,o=i(this);if(r=o[t])for(var u=0;u<r.length;u++)(e=r[u])(n)}},En={instrument:!1};bn.mixin(En);var An=[],jn=a,Tn=void 0,Sn=1,kn=2,Cn=new E,On=new E,In=k;k.prototype._validateInput=function(t){return mn(t)},k.prototype._validationError=function(){return new Error("Array Methods must be provided an Array")},k.prototype._init=function(){this._result=new Array(this.length)},k.prototype._enumerate=function(){for(var t=this.length,n=this.promise,r=this._input,e=0;n._state===Tn&&t>e;e++)this._eachEntry(r[e],e)},k.prototype._eachEntry=function(t,n){var e=this._instanceConstructor;r(t)?t.constructor===e&&t._state!==Tn?(t._onError=null,this._settledAt(t._state,n,t._result)):this._willSettleAt(e.resolve(t),n):(this._remaining--,this._result[n]=this._makeResult(Sn,n,t))},k.prototype._settledAt=function(t,n,r){var e=this.promise;e._state===Tn&&(this._remaining--,this._abortOnReject&&t===kn?w(e,r):this._result[n]=this._makeResult(t,n,r)),0===this._remaining&&m(e,this._result)},k.prototype._makeResult=function(t,n,r){return r},k.prototype._willSettleAt=function(t,n){var r=this;g(t,void 0,function(t){r._settledAt(Sn,n,t)},function(t){r._settledAt(kn,n,t)})};var Rn=C,Mn=O,Pn=I,xn=R,Nn="rsvp_"+wn()+"-",Yn=0,Dn=x;x.cast=Pn,x.all=Rn,x.race=Mn,x.resolve=Pn,x.reject=xn,x.prototype={constructor:x,_guidKey:Nn,_onError:function(t){En.async(function(n){setTimeout(function(){n._onError&&En.trigger("error",t)},0)},this)},then:function(t,n,r){var e=this,o=e._state;if(o===Sn&&!t||o===kn&&!n)return En.instrument&&jn("chained",this,this),this;e._onError=null;var i=new this.constructor(f,r),u=e._result;if(En.instrument&&jn("chained",e,i),o){var s=arguments[o-1];En.async(function(){j(o,i,s,u)})}else g(e,i,t,n);return i},"catch":function(t,n){return this.then(null,t,n)},"finally":function(t,n){var r=this.constructor;return this.then(function(n){return r.resolve(t()).then(function(){return n})},function(n){return r.resolve(t()).then(function(){throw n})},n)}},N.prototype=gn(In.prototype),N.prototype._superConstructor=In,N.prototype._makeResult=S,N.prototype._validationError=function(){return new Error("allSettled must be called with an array")};var Kn,Un,qn=Y,Fn=D,Gn=0,Ln=({}.toString,K),Vn="undefined"!=typeof window?window:void 0,Wn=Vn||{},$n=Wn.MutationObserver||Wn.WebKitMutationObserver,zn="undefined"!=typeof process&&"[object process]"==={}.toString.call(process),Bn="undefined"!=typeof Uint8ClampedArray&&"undefined"!=typeof importScripts&&"undefined"!=typeof MessageChannel,Hn=new Array(1e3);Un=zn?U():$n?F():Bn?G():void 0===Vn&&"function"==typeof require?W():L();var Jn=$,Qn=z,Xn=B;B.prototype=gn(In.prototype),B.prototype._superConstructor=In,B.prototype._init=function(){this._result={}},B.prototype._validateInput=function(t){return t&&"object"==typeof t},B.prototype._validationError=function(){return new Error("Promise.hash must be called with an object")},B.prototype._enumerate=function(){var t=this.promise,n=this._input,r=[];for(var e in n)t._state===Tn&&Object.prototype.hasOwnProperty.call(n,e)&&r.push({position:e,entry:n[e]});var o=r.length;this._remaining=o;for(var i,u=0;t._state===Tn&&o>u;u++)i=r[u],this._eachEntry(i.entry,i.position)},H.prototype=gn(Xn.prototype),H.prototype._superConstructor=In,H.prototype._makeResult=S,H.prototype._validationError=function(){return new Error("hashSettled must be called with an object")};var Zn=J,tr=Q,nr=X,rr=new Z,er=new Z,or=un,ir=fn,ur=ln,sr=hn,ar=pn;En.async=Ln;if("undefined"!=typeof window&&"object"==typeof window.__PROMISE_INSTRUMENTATION__){var cr=window.__PROMISE_INSTRUMENTATION__;u("instrument",!0);for(var fr in cr)cr.hasOwnProperty(fr)&&dn(fr,cr[fr])}var lr={race:ir,Promise:Dn,allSettled:qn,hash:tr,hashSettled:Zn,denodeify:or,on:dn,off:vn,map:nr,filter:Qn,resolve:sr,reject:ur,all:Fn,rethrow:ar,defer:Jn,EventTarget:bn,configure:u,async:_n};"function"==typeof define&&define.amd?define(function(){return lr}):"undefined"!=typeof module&&module.exports?module.exports=lr:"undefined"!=typeof this&&(this.RSVP=lr)}).call(this);